"use strict";var U=Object.create;var y=Object.defineProperty;var _=Object.getOwnPropertyDescriptor;var M=Object.getOwnPropertyNames;var $=Object.getPrototypeOf,P=Object.prototype.hasOwnProperty;var p=(e,t)=>{for(var o in t)y(e,o,{get:t[o],enumerable:!0})},k=(e,t,o,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of M(t))!P.call(e,r)&&r!==o&&y(e,r,{get:()=>t[r],enumerable:!(s=_(t,r))||s.enumerable});return e};var W=(e,t,o)=>(o=e!=null?U($(e)):{},k(t||!e||!e.__esModule?y(o,"default",{value:e,enumerable:!0}):o,e));var B=require("discord.js");var g=require("discord.js");var h=W(require("dotenv"));h.default.config();var{DISCORD_TOKEN:x,DISCORD_CLIENT_ID:F,GLADOS_HOME_GUILD:I}=process.env;if(!x||!F||!I)throw new Error("Missing environment variables");var n={DISCORD_TOKEN:x,DISCORD_CLIENT_ID:F,GLADOS_HOME_GUILD:I};var C={};p(C,{data:()=>q,execute:()=>H});var u=require("discord.js"),q=new u.SlashCommandBuilder().setName("ping").setDescription("Savoir si le bot est en ligne"),c={VERY_GOOD:50,GOOD:100,CORRECT:150,WEAK:200,BAD:500};async function H(e){let t=await e.deferReply({ephemeral:!0,fetchReply:!0}),o,s,r=process.memoryUsage(),a=e.client.ws.ping;!t||a<=0?(o="Pas normal !",s=16711680):a<c.VERY_GOOD?(o="Tr\xE8s bon",s=65280):a<c.GOOD?(o="Bon",s=65280):a<c.CORRECT?(o="Correct",s=65280):a<c.WEAK?(o="Faible",s=16753920):a<c.BAD?(o="Mauvais",s=16711680):(o="Tr\xE8s mauvais",s=16711680);let T=new u.EmbedBuilder().setTitle("\u{1F3D3} Pong !").setDescription(`Le ping est de ${e.client.ws.ping}ms, ce qui est ${o}`).addFields({name:"M\xE9moire utilis\xE9e",value:`${Math.round(r.heapUsed/1024/1024)}MB`,inline:!0},{name:"M\xE9moire totale",value:`${Math.round(r.heapTotal/1024/1024)}MB`,inline:!0}).setTimestamp().setColor(s).setFooter({text:"GLaDOS Assistant - Pour vous servir.",iconURL:e.client.user.displayAvatarURL()});await e.editReply({embeds:[T]})}var R={};p(R,{data:()=>K,execute:()=>j});var f=require("discord.js"),K=new f.SlashCommandBuilder().setName("info").setDescription("Informations sur le bot");async function j(e){let t=await e.deferReply({ephemeral:!0,fetchReply:!0}),o=new f.EmbedBuilder().setTitle("GLaDOS Assistant").setDescription("Je suis un bot Discord cr\xE9\xE9 par [Wiibleyde](https://github.com/Wiibleyde) pour vous aider dans votre quotidien.").addFields({name:"Version",value:"1.0.0",inline:!0},{name:"Langage",value:"TypeScript",inline:!0},{name:"Biblioth\xE8que",value:"discord.js",inline:!0},{name:"D\xE9p\xF4t GitHub",value:"[Cliquez ici](https://github.com/Wiibleyde/GLaDOS-Assistant)",inline:!0}).setTimestamp().setColor(16777215).setFooter({text:"GLaDOS Assistant - Pour vous servir.",iconURL:e.client.user.displayAvatarURL()});await e.editReply({embeds:[o]})}var b={};p(b,{data:()=>V,execute:()=>J});var G=require("discord.js");var v=require("discord.js");function L(e,t){return new v.EmbedBuilder().setTitle("Erreur :warning:").setDescription(t.message).setColor(16711680).setFooter({text:"GLaDOS Assistant - Pour vous servir.",iconURL:e.client.user.displayAvatarURL()})}function S(e,t){return new v.EmbedBuilder().setTitle("Succ\xE8s !").setDescription(t).setColor(65280).setFooter({text:"GLaDOS Assistant - Pour vous servir.",iconURL:e.client.user.displayAvatarURL()})}var V=new G.SlashCommandBuilder().setName("talk").setDescription("Parler avec le bot").addStringOption(e=>e.setName("message").setDescription("Le message \xE0 envoyer").setRequired(!0));async function J(e){let t=await e.deferReply({ephemeral:!0,fetchReply:!0}),o=e.channel,s=e.options.get("message")?.value;if(!o){await e.editReply({embeds:[L(e,new Error("Impossible de trouver le salon de discussion"))]});return}await o.send(s),await e.editReply({embeds:[S(e,"Message envoy\xE9")]})}var E={};p(E,{data:()=>Y,execute:()=>z});var N=require("discord.js"),Y=new N.SlashCommandBuilder().setName("logs").setDescription("Afficher les derniers logs du bot");async function z(e){let t=await e.deferReply({ephemeral:!0,fetchReply:!0})}var l={ping:C,info:R,talk:b},d={logs:E};var A=require("@prisma/client"),i=new A.PrismaClient;var w=class{async initLevels(){await i.logLevel.createMany({data:[{name:"ERROR"},{name:"INFO"},{name:"WARN"},{name:"DEBUG"},{name:"TRACE"}],skipDuplicates:!0})}getNowDate(){return new Date().toISOString()}async info(t){console.log(`[INFO] ${this.getNowDate()} ${t}`),await i.logs.create({data:{message:t,level:{connect:{name:"INFO"}}}})}async error(t){console.error(`[ERROR] ${this.getNowDate()} ${t}`),await i.logs.create({data:{message:t,level:{connect:{name:"ERROR"}}}})}async warn(t){console.warn(`[WARN] ${this.getNowDate()} ${t}`),await i.logs.create({data:{message:t,level:{connect:{name:"WARN"}}}})}async debug(t){console.debug(`[DEBUG] ${this.getNowDate()} ${t}`),await i.logs.create({data:{message:t,level:{connect:{name:"DEBUG"}}}})}},m=new w;var ye=Object.values(l).map(e=>e.data),Q=Object.values(d).map(e=>e.data),X=new g.REST().setToken(n.DISCORD_TOKEN);async function O(e){try{m.info("Chargement des commandes pour la guilde..."),await X.put(g.Routes.applicationGuildCommands(n.DISCORD_CLIENT_ID,e),{body:Q}),m.info("Commandes charg\xE9es avec succ\xE8s pour la guilde !")}catch(t){m.error(t)}}var D=new B.Client({intents:["Guilds","GuildMessages","DirectMessages"]});m.initLevels();D.once("ready",()=>{D.guilds.cache.map(o=>o.id).forEach(o=>{O(o)});let t=n.GLADOS_HOME_GUILD;O(t)});D.on("interactionCreate",async e=>{if(!e.isCommand())return;let{commandName:t}=e;l[t]&&l[t].execute(e),d[t]&&d[t].execute(e)});D.login(n.DISCORD_TOKEN);
